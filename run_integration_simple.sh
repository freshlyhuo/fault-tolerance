#!/bin/bash

# ç®€åŒ–ç‰ˆé›†æˆæµ‹è¯•è¿è¡Œè„šæœ¬

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘     å¥åº·ç›‘æµ‹ + æ•…éšœè¯Šæ–­ é›†æˆæµ‹è¯• (ç®€åŒ–ç‰ˆ)                     â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

cd /home/yzj/fault-tolerance

# æ£€æŸ¥é…ç½®æ–‡ä»¶
echo "ğŸ“‹ æ£€æŸ¥é…ç½®æ–‡ä»¶..."
if [ ! -f "fault-diagnosis/configs/fault_tree_business.json" ]; then
    echo "âŒ ç¼ºå°‘ä¸šåŠ¡å±‚æ•…éšœæ ‘é…ç½®æ–‡ä»¶"
    exit 1
fi

if [ ! -f "fault-diagnosis/configs/fault_tree_microservice.json" ]; then
    echo "âŒ ç¼ºå°‘å¾®æœåŠ¡å±‚æ•…éšœæ ‘é…ç½®æ–‡ä»¶"
    exit 1
fi
echo "âœ“ é…ç½®æ–‡ä»¶æ£€æŸ¥é€šè¿‡"
echo ""

# æ„å»º
echo "ğŸ”¨ æ„å»ºé›†æˆæµ‹è¯•ç¨‹åº..."
mkdir -p build
go build -o build/integration-simple cmd/integration_simple/main.go
if [ $? -ne 0 ]; then
    echo "âŒ æ„å»ºå¤±è´¥"
    exit 1
fi
echo "âœ“ æ„å»ºæˆåŠŸ"
echo ""

# è¿è¡Œ
echo "ğŸš€ å¯åŠ¨é›†æˆæµ‹è¯•..."
echo ""
./build/integration-simple

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘     æµ‹è¯•ç»“æŸ                                                  â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
